---
import Layout from "../layouts/Layout.astro";
---

<Layout>
	<section
		id="home"
		class="relative flex flex-col flex-wrap justify-center items-center text-center overflow-hidden py-4 min-h-screen w-full text-white home"
	>
		<div class="two-images relative max-sm:max-w-sm sm:max-w-screen-sm h-auto">
			<img class="relative top-0 left-0 w-auto h-auto" src="/images/white_logo.png" alt="White Logo" />
			<img class="absolute top-0 left-0 w-full h-full superimposed" src="/images/image.png"  alt="Logo" />
		</div>
		<h2 class="text-3xl drop-shadow-md">Aeromodelling Club of RVCE</h2>

		<!-- Registration info -->
		<div class="flex justify-center items-center py-4">
			<p class="text-lg font-bold text-white">Registrations Closed! See you next year ✈️</p>
		</div>

		<div class="flex justify-center items-center py-4">
			<a 
				href="https://www.instagram.com/teamvyomaofficial/" 
				class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded"
				target="_blank" 
				rel="noopener noreferrer">
				View Results Here!
			</a>
		</div>

		<div class="h-32 wave"></div>
		<div class="h-32 wave wave2"></div>
		<div class="h-32 wave wave3"></div>
	</section>

	<div class="pt-5 pb-5">
		<div class="container">
			<div class="row">
				<div class="section-head col-sm-12" id="service">
					<h1 class="mt-32">VISION</h1>
					<p>To foster innovation and creativity in the field of aeromodelling</p>
					<a class="text-[#406E9F] hover:text-vyoma-blue hover:no-underline text-2xl" href="/about">Learn More</a>
				</div>
			</div>
		</div>
	</div>

	<div class="h-10 text-center items-center bg-[url(/images/newbg2.jpg)] bg-no-repeat bg-cover bg-fixed bg-center w-full text-white min-h-[35vh] px-5 py-10"></div>

	<section id="contact" class="contact">
		<h1 class="heading">We'd Love to Hear from You! Get in Touch</h1>
	</section>

	<div class="contact-in">
		<div class="contact-map">
			<iframe
				src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d15567.912881370632!2d77.45077965157242!3d12.889661394479894!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x3bae3ee159ba3729%3A0x75a3463d510cf26e!2sR.%20V.%20College%20of%20Engineering!5e0!3m2!1sen!2sin!4v1689627383432!5m2!1sen!2sin"
				width="100%"
				height="450"
				style="border: 0"
				allowfullscreen
				loading="eager"
			></iframe>
		</div>

		<form id="contact-form" class="contact-form">
			<input type="text" id="name" placeholder="Name" class="contact-form-txt" required name="from_name" />
			<input type="tel" id="phone" pattern="[0-9]{10}" required placeholder="Contact number" maxlength="10" class="contact-form-phone" name="contact" />
			<input type="email" id="email" placeholder="Email" class="contact-form-email" required name="email_id" />
			<textarea placeholder="Your Message" name="message" class="contact-form-txtarea" required></textarea>
			<input type="submit" value="Submit" name="submit" class="contact-form-btn" />
			<div id="form-status" class="mt-4 text-center hidden">
				<p id="success-message" class="text-green-500 font-bold hidden">Message sent successfully!</p>
				<p id="error-message" class="text-red-500 font-bold hidden">Error sending message. Please try again.</p>
			</div>
		</form>
	</div>
</Layout>

<script is:inline>
	// Load EmailJS library
	(function() {
		const script = document.createElement('script');
		script.src = 'https://cdn.emailjs.com/dist/email.min.js';
		script.async = true;
		
		script.onload = function() {
			// TypeScript safe initialization of EmailJS
			window.emailjs.init("vZCxqvwZ1AXGnk8TU");
			
			const form = document.getElementById('contact-form');
			const statusDiv = document.getElementById('form-status');
			const successMessage = document.getElementById('success-message');
			const errorMessage = document.getElementById('error-message');
			
			if (form) {
				form.addEventListener('submit', function(event) {
					event.preventDefault();
					
					// Get the submit button with proper typecasting
					const submitButton = form.querySelector('input[type="submit"]');
					const originalButtonText = submitButton ? submitButton.value : 'Submit';
					
					if (submitButton) {
						submitButton.value = 'Sending...';
						submitButton.disabled = true;
					}
					
					// Handle status display
					if (statusDiv) statusDiv.classList.remove('hidden');
					if (successMessage) successMessage.classList.add('hidden');
					if (errorMessage) errorMessage.classList.add('hidden');
					
					// Send the form using EmailJS
					window.emailjs.sendForm('service_huh7r0d', 'template_rpldw7w', form)
						.then(function() {
							// Show success message
							if (successMessage) successMessage.classList.remove('hidden');
							// Reset the form
							form.reset();
						})
						.catch(function(error) {
							// Show error message
							if (errorMessage) {
								errorMessage.textContent = 'Error sending message: ' + error.text;
								errorMessage.classList.remove('hidden');
							}
							console.error('EmailJS error:', error);
						})
						.finally(function() {
							// Re-enable submit button
							if (submitButton) {
								submitButton.value = originalButtonText;
								submitButton.disabled = false;
							}
						});
				});
			}
		};
		
		script.onerror = function() {
			console.error('Failed to load EmailJS script');
			const form = document.getElementById('contact-form');
			if (form) {
				const errorDiv = document.createElement('div');
				errorDiv.className = 'text-red-500 text-center mt-4';
				errorDiv.textContent = 'Unable to load email service. Please try again later.';
				form.appendChild(errorDiv);
			}
		};
		
		document.head.appendChild(script);
	})();
</script>